<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Time data ·  </title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../"><img class="logo" src="../assets/logo.png" alt="  logo"/></a><h1> </h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><a class="toctext" href="../architecture/">Architecture</a></li><li><a class="toctext" href="../fileIO/">File I/O</a></li><li><a class="toctext" href="../preprocessing/">Preprocessing</a></li><li><a class="toctext" href="../generatingdata/">Generating Data</a></li><li><span class="toctext">Fit and Predict</span><ul><li class="current"><a class="toctext" href>Time data</a><ul class="internal"><li><a class="toctext" href="#Fitting-1">Fitting</a></li><li><a class="toctext" href="#Predicting-1">Predicting</a></li></ul></li><li><a class="toctext" href="../fitpredictFreq/">Frequency data</a></li></ul></li><li><span class="toctext">Models</span><ul><li><a class="toctext" href="../elements/">Basic Elements</a></li><li><a class="toctext" href="../fractionalMaxwell/">Maxwell</a></li><li><a class="toctext" href="../fractionalKelvinVoigt/">Kelvin-Voigt</a></li><li><a class="toctext" href="../fractionalZener/">Zener</a></li><li><a class="toctext" href="../fractionalPT/">Poynting-Thomson</a></li><li><a class="toctext" href="../burgers/">Burgers</a></li><li><a class="toctext" href="../createmodel/">Create Your Model</a></li></ul></li><li><a class="toctext" href="../examples/">Examples</a></li><li><a class="toctext" href="../API/">API</a></li></ul></nav><article id="docs"><header><nav><ul><li>Fit and Predict</li><li><a href>Time data</a></li></ul><a class="edit-page" href="https://github.com/JuliaRheology/RHEOS.jl/blob/master/docs/src-staging/fitpredictTime.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Time data</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Fitting-and-Predicting-Time-data-1" href="#Fitting-and-Predicting-Time-data-1">Fitting and Predicting - Time data</a></h1><p>A large majority of scientists and engineers who undertanke rheological experiments would fit their data with one or several viscoelastic models in order to classify materials, quantify their behaviour and predict their response to external perturbations.</p><p>Standard linear viscoelastic models take the form of an ordinary differential equation between stress <span>$\sigma$</span> and strain <span>$\epsilon$</span>. Fitting models and predicting their response in the time domain then requires computing viscoelastic hereditary integrals such as:</p><div>\[ \sigma(t) = \int_{0}^t G(t - \tau) \frac{d \epsilon(\tau)}{d \tau} d \tau \]</div><p>where <span>$G$</span> is the relaxation response (stress response to a step in strain) of the material, which can be analytically or numerically defined for each rheological model and its set of rheological parameters. A similar relation exists to calculate the strain from the stress history</p><div>\[ \epsilon(t) = \int_{0}^t J(t - \tau) \frac{d \sigma(\tau)}{d \tau} d \tau \]</div><p>where <span>$J$</span> is the creep modulus of the material. Fitting and predicting behaviour then becomes non-trivial and standardised tools to process are needed.</p><pre class="language-julia"><code class="language-julia">using RHEOS</code></pre><h2><a class="nav-anchor" id="Fitting-1" href="#Fitting-1">Fitting</a></h2><p><strong>Step 1: Loading of the experimental data</strong></p><p>RHEOS has a convenient function to import data from CSV files (more information in <a href="../fileIO/#File-I/O-1">File I/O</a> section).</p><pre class="language-julia"><code class="language-julia">data = importcsv(&quot;data_time.csv&quot;, t_col=1, ϵ_col=2, σ_col=3);
RheoTimeDataType(data)</code></pre><pre class="language-output"><code class="language-output">┌ Warning: Please note that NaN data rows are not included in resultant data struct.
└ @ RHEOS /home/alessandra/.julia/dev/RHEOS/src/IO.jl:11</code></pre><pre class="language-output"><code class="language-output">strain_and_stress::TimeDataType = 3</code></pre><p>The time, strain and stress data are stored into a <a href="../API/#RHEOS.RheoTimeData"><code>RheoTimeData</code></a> struct. </p><p><strong>Step 2: Model fit</strong></p><p>Let&#39;s fit a Maxwell model via its relaxation modulus, G, as our data is from a stress relaxation test, thus the strain is imposed. The first argument is our data, the second argument tells RHEOS which model to fit (<a href="../API/#RHEOS.RheoModelClass"><code>RheoModelClass</code></a>) and the final argument tells RHEOS whether to fit the model using a relaxation modulus (strain<em>impsed) or creep modulus (stress</em>imposed). The function will return a <a href="../API/#RHEOS.RheoModel"><code>RheoModel</code></a> object, i.e. a <a href="../API/#RHEOS.RheoModelClass"><code>RheoModelClass</code></a> with fixed values for the parameters. </p><pre class="language-julia"><code class="language-julia">maxwell_model = modelfit(data, Maxwell, strain_imposed)</code></pre><pre class="language-output"><code class="language-output">┌ Warning: Initial values for model parameters is set to [0.5, 0.5] by default
└ @ RHEOS /home/alessandra/.julia/dev/RHEOS/src/processing.jl:212</code></pre><pre class="language-output"><code class="language-output">Time: 2.136837673 s, Why: XTOL_REACHED, Parameters: [4.0054, 2.003], Error: 0.022310985023644148</code></pre><pre class="language-output"><code class="language-output">Model: maxwell

Parameter values: (η = 4.0054017305374146, k = 2.003000020980835) 

                ___
            _____| |________╱╲  ╱╲  ╱╲  ___
                _|_|          ╲╱  ╲╱  ╲╱
                  η                  k</code></pre><p>For the fitting process RHEOS relies on the optimistion package <a href="https://nlopt.readthedocs.io/en/latest/">NLopt.jl</a>. RHEOS makes use of a local derivative free algorithm, specifically the Tom Rowan&#39;s &quot;Subplex&quot; algorithm originally introduced in </p><ul><li>T. Rowan, &quot;Functional Stability Analysis of Numerical Algorithms&quot;, Ph.D. thesis, Department of Computer Sciences, University of Texas at Austin, 1990.</li></ul><p>Next, we will fit a fractional Maxwell (spring) model (the only difference from the above model is that the dash-pot is replaced by a spring-pot). This time we will also add upper and lower bounds on the model parameters. This is highly recommended for fractional models in particular as values less than <code>0</code> or greater than <code>1</code> for the spring-pot parameter are unphysical and can cause errors in the Mittag-Leffler function used (more information about the fractional models in review TBA). To facilitate the convergence of the fitting algorithm, it is also suggested to define an initial set of parameters (the function uses <code>0.5</code> for all parameters not defined). For initial parameters, lower bounds and upper bounds, it is possible to only specify some of the parameters and the rest will be filled in automatically.</p><pre class="language-julia"><code class="language-julia"># Lower bounds
Lo = (cₐ=0.0, a=0.01, k=0.0)
# Upper bounds
Hi = (cₐ=Inf, a=0.99, k=Inf)
# Initial parameters
P0 = (cₐ=0.1, a=0.2, k=2.0)

Fmaxwell_model = modelfit(data, FractS_Maxwell, strain_imposed,lo = Lo, hi = Hi, p0 = P0)</code></pre><pre class="language-output"><code class="language-output">Time: 1.866023795 s, Why: XTOL_REACHED, Parameters: [3.93835, 0.99, 2.02904], Error: 0.026470897141755965</code></pre><pre class="language-output"><code class="language-output">Model: fractmaxwell_spring

Parameter values: (cₐ = 3.9383500588392377, a = 0.99, k = 2.029041423678936) 

           ___╱╲_________╱╲  ╱╲  ╱╲  ________
              ╲╱           ╲╱  ╲╱  ╲╱
                cₐ,a               k</code></pre><p>Further optional parameters can be defined in the fitting function, such as the relative tolerance (default parameter of 1e-4) or the finite difference formula to use for the derivative (<code>&quot;BD&quot;</code> = Backward Difference (default), <code>&quot;CD&quot;</code> = Central Difference). If the user is interested in the model parameters on each optimisation iteration, they can be printed on the terminal by enabling <code>verbose = true</code>. </p><p><strong>IMPORTANT NOTE</strong> Often an ideal step loading is assumed, which simplifies the equations in the first section to <span>$\sigma(t) = G(t) \epsilon_0$</span> and <span>$\epsilon(t) = J(t) \sigma_0$</span>. This enables the modulus to be used directly for the fitting, which vastly reduces the computational burden. For this reason, RHEOS provides a dedicated function <a href="../API/#RHEOS.modelstepfit"><code>modelstepfit</code></a> that requires the same parameters as <a href="../API/#RHEOS.modelfit"><code>modelfit</code></a>. If this assumption is appropriate for the data then fitting can be sped up greatly by use of this function.</p><h2><a class="nav-anchor" id="Predicting-1" href="#Predicting-1">Predicting</a></h2><p>RHEOS allows the user to simulate the response of a model (with defined parameters, <a href="../API/#RHEOS.RheoModel"><code>RheoModel</code></a> struct) to an imposed loading. </p><p>Given an incomplete data set (time data with only either stress or strain missing) and model with values substituted into parameters (<a href="../API/#RHEOS.RheoModel"><code>RheoModel</code></a>), return a new &quot;complete&quot; dataset based on the model with the simulated missing variable.</p><p><strong>Assess quality of the fit</strong></p><p>The ability of predicting model&#39;s response is first exploited to assess the quality of the fits above. The incomplete <a href="../API/#RHEOS.RheoTimeData"><code>RheoTimeData</code></a> variable is defined by extracting the time and the imposed variable (for the current example, the strain).</p><pre class="language-julia"><code class="language-julia">data_ext = extract(data,strain_only);
# alternatively: data_ext = extract(data,1);

RheoTimeDataType(data_ext)</code></pre><pre class="language-output"><code class="language-output">strain_only::TimeDataType = 1</code></pre><p>For the prediction, RHEOS&#39; function <a href="../API/#RHEOS.modelpredict"><code>modelpredict</code></a> requires the incomplete data set and a model with fixed parameters (<a href="../API/#RHEOS.RheoModel"><code>RheoModel</code></a>). For the assessment of the fitting quality the <a href="../API/#RHEOS.RheoModel"><code>RheoModel</code></a> required is the output of the fitting function. </p><pre class="language-julia"><code class="language-julia">maxwell_predict = modelpredict(data_ext, maxwell_model)

# Now we can plot data and model together for comparison
using PyPlot
plot(data.t,data.σ, &quot;o&quot;, markersize = 5);
plot(maxwell_predict.t,maxwell_predict.σ, color = &quot;red&quot;);
xlabel(&quot;Time&quot;);
ylabel(&quot;Stress&quot;);</code></pre><p><img src="../fitpredictTime_files/fitpredictTime_20_0.png" alt="png"/></p><p><strong>Simulate different model behaviours</strong></p><p>The ability of predicting model&#39;s response can be exploited to simulate the behaviour of the model to other external loading conditions. For example, we will explore the response of the fitted model to a creep experiment. </p><p>First we need to define an incomplete <a href="../API/#RHEOS.RheoTimeData"><code>RheoTimeData</code></a> struct, which can be achieved via the data generation functions provided in RHEOS (see section <a href="../generatingdata/#Generating-Data-1">Generating Data</a>).</p><pre class="language-julia"><code class="language-julia"># Define timeline
dσ = timeline()
# and a step in stress
dσ = stressfunction(dσ,hstep())

# we can now predict the creep response of the Maxwell model 
maxwell_creepPredict = modelsteppredict(dσ,maxwell_model)
# Visualisation of the imposed loading
plot(maxwell_creepPredict.t,maxwell_creepPredict.σ, &quot;--&quot;)
# Visualisation of the simulated response
plot(maxwell_creepPredict.t,maxwell_creepPredict.ϵ);
xlabel(&quot;Time&quot;);
ylabel(&quot;Strain&quot;);</code></pre><p><img src="../fitpredictTime_files/fitpredictTime_23_0.png" alt="png"/></p><p><strong>IMPORTANT NOTE</strong> As for the fitting procedure, if an ideal step loading is assumed, RHEOS provides a dedicated function <a href="../API/#RHEOS.modelsteppredict"><code>modelsteppredict</code></a> that requires the same parameters as <a href="../API/#RHEOS.modelpredict"><code>modelpredict</code></a> which significantly reduces the computating time. </p><p>Similarly, more complex behaviour can be simulated (such as a stairs loading).</p><pre class="language-julia"><code class="language-julia"># Define timeline
dσ = timeline()
# and a step in stress
dσ = stressfunction(dσ,stairs())

# we can now predict the stairs response of the Maxwell model 
maxwell_creepPredict = modelpredict(dσ,maxwell_model)
# Plotting
plot(maxwell_creepPredict.t,maxwell_creepPredict.σ, &quot;--&quot;)
plot(maxwell_creepPredict.t,maxwell_creepPredict.ϵ);
xlabel(&quot;Time&quot;);
ylabel(&quot;Strain&quot;);</code></pre><p><img src="../fitpredictTime_files/fitpredictTime_26_0.png" alt="png"/></p><footer><hr/><a class="previous" href="../generatingdata/"><span class="direction">Previous</span><span class="title">Generating Data</span></a><a class="next" href="../fitpredictFreq/"><span class="direction">Next</span><span class="title">Frequency data</span></a></footer></article></body></html>
